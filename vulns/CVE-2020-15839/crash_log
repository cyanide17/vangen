../../src/qemu-4.2/build/i386-softmmu/qemu-system-i386 -serial mon:stdio -device e1000e,netdev=mynet1 -netdev user,id=mynet1,hostfwd=tcp::1234-:22 -device ES1370 -drive file=fs.img,index=1,media=disk,format=raw -drive file=build/hyfuzz.img,index=0,media=disk,format=raw -m 1024
==12489==WARNING: ASan doesn't fully support makecontext/swapcontext functions and may produce false positives in some cases!
==12489==WARNING: ASan is ignoring requested __asan_handle_no_return: stack top: 0x7ffc8cb6d000; bottom 0x7f9fde9fe000; size: 0x005cae16f000 (398057730048)
False positive error reports may follow
For details see https://github.com/google/sanitizers/issues/189
xv6...
probing PCI...
PCI function 0:0.0 (8086:1237) enabled
PCI function 0:1.0 (8086:7000) enabled
PCI function 0:1.1 (8086:7010) enabled
PCI function 0:1.3 (8086:7113) enabled
PCI function 0:2.0 (1234:1111) enabled
PCI function 0:3.0 (8086:10d3) enabled
PCI function 0:4.0 (1274:5000) enabled
e1000e: if (core->mac[TARC0] & E1000_TARC_ENABLE)
e1000e: if (core->mac[TARC0] & E1000_TARC_ENABLE)
e1000e: if (core->mac[TARC1] & E1000_TARC_ENABLE)
=================================================================
==12489==ERROR: AddressSanitizer: heap-use-after-free on address 0x62500219900e at pc 0x5605e147bfd8 bp 0x7fa01f4f8eb0 sp 0x7fa01f4f8ea0
READ of size 2 at 0x62500219900e thread T2
    #0 0x5605e147bfd7 in lduw_he_p /home/cwmyung/prj/hyfuzz/src/qemu-4.2/include/qemu/bswap.h:332
    #1 0x5605e147bfd7 in ldn_he_p /home/cwmyung/prj/hyfuzz/src/qemu-4.2/include/qemu/bswap.h:550
    #2 0x5605e147bfd7 in flatview_write_continue /home/cwmyung/prj/hyfuzz/src/qemu-4.2/exec.c:3128
    #3 0x5605e147c110 in flatview_write /home/cwmyung/prj/hyfuzz/src/qemu-4.2/exec.c:3169
    #4 0x5605e1486cc7 in address_space_write /home/cwmyung/prj/hyfuzz/src/qemu-4.2/exec.c:3259
    #5 0x5605e1aef308 in dma_memory_rw_relaxed /home/cwmyung/prj/hyfuzz/src/qemu-4.2/include/sysemu/dma.h:87
    #6 0x5605e1aef308 in dma_memory_rw /home/cwmyung/prj/hyfuzz/src/qemu-4.2/include/sysemu/dma.h:110
    #7 0x5605e1aef308 in pci_dma_rw /home/cwmyung/prj/hyfuzz/src/qemu-4.2/include/hw/pci/pci.h:786
    #8 0x5605e1aef308 in pci_dma_write /home/cwmyung/prj/hyfuzz/src/qemu-4.2/include/hw/pci/pci.h:799
    #9 0x5605e1aef308 in e1000e_write_to_rx_buffers /home/cwmyung/prj/hyfuzz/src/qemu-4.2/hw/net/e1000e_core.c:1412
    #10 0x5605e1b053cb in e1000e_write_packet_to_guest /home/cwmyung/prj/hyfuzz/src/qemu-4.2/hw/net/e1000e_core.c:1582
    #11 0x5605e1b053cb in e1000e_receive_iov /home/cwmyung/prj/hyfuzz/src/qemu-4.2/hw/net/e1000e_core.c:1709
    #12 0x5605e1add650 in net_tx_pkt_sendv /home/cwmyung/prj/hyfuzz/src/qemu-4.2/hw/net/net_tx_pkt.c:544
    #13 0x5605e1add650 in net_tx_pkt_send /home/cwmyung/prj/hyfuzz/src/qemu-4.2/hw/net/net_tx_pkt.c:620
    #14 0x5605e1addc6a in net_tx_pkt_send_loopback /home/cwmyung/prj/hyfuzz/src/qemu-4.2/hw/net/net_tx_pkt.c:633
    #15 0x5605e1aff86a in e1000e_tx_pkt_send /home/cwmyung/prj/hyfuzz/src/qemu-4.2/hw/net/e1000e_core.c:664
    #16 0x5605e1aff86a in e1000e_process_tx_desc /home/cwmyung/prj/hyfuzz/src/qemu-4.2/hw/net/e1000e_core.c:743
    #17 0x5605e1aff86a in e1000e_start_xmit /home/cwmyung/prj/hyfuzz/src/qemu-4.2/hw/net/e1000e_core.c:934
    #18 0x5605e1b01115 in e1000e_set_tctl /home/cwmyung/prj/hyfuzz/src/qemu-4.2/hw/net/e1000e_core.c:2432
    #19 0x5605e1b0a961 in e1000e_core_write /home/cwmyung/prj/hyfuzz/src/qemu-4.2/hw/net/e1000e_core.c:3258
    #20 0x5605e1542cbd in memory_region_write_accessor /home/cwmyung/prj/hyfuzz/src/qemu-4.2/memory.c:483
    #21 0x5605e153c48d in access_with_adjusted_size /home/cwmyung/prj/hyfuzz/src/qemu-4.2/memory.c:544
    #22 0x5605e15496d1 in memory_region_dispatch_write /home/cwmyung/prj/hyfuzz/src/qemu-4.2/memory.c:1482
    #23 0x5605e1578745 in io_writex /home/cwmyung/prj/hyfuzz/src/qemu-4.2/accel/tcg/cputlb.c:977
    #24 0x5605e158365e in store_helper /home/cwmyung/prj/hyfuzz/src/qemu-4.2/accel/tcg/cputlb.c:1716
    #25 0x5605e158365e in helper_le_stl_mmu /home/cwmyung/prj/hyfuzz/src/qemu-4.2/accel/tcg/cputlb.c:1836
    #26 0x7fa01f9348fb  (<unknown module>)

0x62500219900e is located 14 bytes inside of 90-byte region [0x625002199000,0x62500219905a)
freed by thread T2 here:
    #0 0x7fa052b007a8 in __interceptor_free (/usr/lib/x86_64-linux-gnu/libasan.so.4+0xde7a8)
    #1 0x5605e20c44de in qemu_vfree /home/cwmyung/prj/hyfuzz/src/qemu-4.2/util/oslib-posix.c:225

previously allocated by thread T2 here:
    #0 0x7fa052b01790 in posix_memalign (/usr/lib/x86_64-linux-gnu/libasan.so.4+0xdf790)
    #1 0x5605e20c3f25 in qemu_try_memalign /home/cwmyung/prj/hyfuzz/src/qemu-4.2/util/oslib-posix.c:185

Thread T2 created by T0 here:
    #0 0x7fa052a59d2f in __interceptor_pthread_create (/usr/lib/x86_64-linux-gnu/libasan.so.4+0x37d2f)
    #1 0x5605e20c8a8a in qemu_thread_create /home/cwmyung/prj/hyfuzz/src/qemu-4.2/util/qemu-thread-posix.c:556

SUMMARY: AddressSanitizer: heap-use-after-free /home/cwmyung/prj/hyfuzz/src/qemu-4.2/include/qemu/bswap.h:332 in lduw_he_p
Shadow bytes around the buggy address:
  0x0c4a8042b1b0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c4a8042b1c0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c4a8042b1d0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c4a8042b1e0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c4a8042b1f0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
=>0x0c4a8042b200: fd[fd]fd fd fd fd fd fd fd fd fd fd fa fa fa fa
  0x0c4a8042b210: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c4a8042b220: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c4a8042b230: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c4a8042b240: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c4a8042b250: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==12489==ABORTING

